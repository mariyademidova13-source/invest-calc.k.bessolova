<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Калькулятор складного відсотка — Інвестиції Крістіна</title>
  <meta name="color-scheme" content="light dark" />
  <meta name="description" content="Український калькулятор складного відсотка: щомісячні внески, вибір частоти капіталізації, графік зростання та підсумок." />
  <style>
    :root{
      --brand-1:#0b8a4b;   /* зелений */
      --brand-2:#003906;   /* темний зелений */
      --brand-3:#295e4c;   /* глибокий зелений */
      --accent-1:#b67900;  /* золото */
      --accent-2:#d3a000;  /* світліше золото */

      --bg-1:#faf6cf; --bg-2:#f1dcc2; --bg-3:#f4f6cf;

      --ink:#0f172a; --muted:#4b5563; --line:#e5e7eb;
      --page:#ffffff; --panel:#ffffff;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --ink:#e5e7eb; --muted:#9ca3af; --line:#24303a;
        --page:#0b0f19; --panel:#0f1623;
        --bg-1:#0f2419; --bg-2:#201a12; --bg-3:#1a2010;
      }
    }

    *{ box-sizing:border-box }
    html,body{ margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:var(--ink); background:var(--page) }

    header{ background: linear-gradient(135deg, var(--brand-2), var(--brand-3)); color:#fff; }
    .wrap{ max-width:1000px; margin:0 auto; padding:16px }
    .topbar{ display:flex; align-items:center; gap:12px; }
    .logo{ width:40px; height:40px; border-radius:8px; object-fit:contain; background:#fff1; padding:4px }
    h1{ margin:4px 0 0; font-size:24px; line-height:1.2; }
    .subtitle{ opacity:.9; margin-top:4px }
    .hero-info{ background: linear-gradient(180deg, var(--bg-1), #ffffff00); border:1px solid var(--line); border-radius:16px; padding:14px; margin-top:12px; }

    .grid{ display:grid; gap:16px; grid-template-columns:1fr; padding:16px }
    @media (min-width:960px){ .grid{ grid-template-columns:1.2fr .8fr } }

    .card{ background:var(--panel); border:1px solid var(--line); border-radius:16px; padding:16px }
    .row{ display:grid; gap:12px; grid-template-columns:1fr; }
    @media (min-width:640px){ .row{ grid-template-columns:1fr 1fr } }
    label{ display:block; font-size:14px; font-weight:600; margin-bottom:6px }
    input, select{ width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--line); background:var(--panel); color:var(--ink); font-size:16px; }
    .hint{ font-size:12px; color:var(--muted); margin-top:6px }

    .btn{ appearance:none; border:0; border-radius:12px; padding:14px 16px; font-weight:700; cursor:pointer }
    .btn-primary{ background:var(--accent-2); color:#1a1a1a }
    .btn-primary:hover{ background:var(--accent-1) }
    .btn-ghost{ background:var(--bg-3); color:#243b2f; border:1px dashed #00000022 }

    .results{ display:flex; flex-direction:column; gap:12px }
    .badge{ display:inline-block; padding:4px 8px; border-radius:999px; background:#ffffff20; border:1px dashed #ffffff40; font-size:12px }
    .result-box{ background:linear-gradient(135deg, var(--brand-1), var(--brand-3)); color:#fff; border-radius:14px; padding:16px; display:flex; flex-direction:column; gap:6px; }
    .result-box .sum{ font-size:36px; font-weight:800 }

    .table-wrap{ overflow:auto; max-height:340px; border:1px solid var(--line); border-radius:12px; background:var(--panel) }
    table{ width:100%; border-collapse:collapse; font-size:12px }
    th,td{ padding:8px 10px; border-bottom:1px solid var(--line); text-align:right; white-space:nowrap }
    th:first-child,td:first-child{ text-align:left }

    /* Графік */
    .chart-card{ background:var(--panel); border:1px solid var(--line); border-radius:16px; padding:16px; }
    canvas{ width:100%; height:280px; display:block; border:1px solid var(--line); border-radius:12px; background:var(--panel); }

    /* CTA */
    .cta{ background: linear-gradient(135deg, var(--brand-1), var(--brand-3)); color:#fff; border-radius:16px; padding:18px; display:flex; flex-direction:column; gap:8px; align-items:flex-start }
    .cta .btn{ background:#fff; color:#133; }
    .cta .btn:hover{ background:#f8f8f8 }

    /* FAQ */
    .faq details{ border:1px solid var(--line); border-radius:12px; padding:12px 14px; background:var(--panel) }
    .faq summary{ cursor:pointer; font-weight:700 }
    .faq details+details{ margin-top:10px }
    footer{ text-align:center; font-size:12px; color:var(--muted); padding:20px 16px }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="topbar">
        <img class="logo" src="assets/logo.png" alt="Active Invest School логотип" onerror="this.style.display='none'">
        <div>
          <h1>Інвестиції Крістіна — калькулятор складного відсотка</h1>
          <div class="subtitle">Щомісячні внески + частота капіталізації (Місячно / Квартально / Піврічно / Річно)</div>
        </div>
      </div>
      <div class="hero-info">Порада: змінюйте ставку й частоту капіталізації — побачите, як змінюється швидкість росту.</div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">
      <!-- Форма -->
      <section class="card">
        <div class="row">
          <div>
            <label>Валюта відображення</label>
            <select id="currency">
              <option value="UAH">₴ UAH</option>
              <option value="USD" selected>$ USD</option>
              <option value="EUR">€ EUR</option>
            </select>
          </div>
          <div>
            <label>Частота капіталізації</label>
            <select id="m">
              <option value="12" selected>Місячно (12×/рік)</option>
              <option value="4">Квартально (4×/рік)</option>
              <option value="2">Піврічно (2×/рік)</option>
              <option value="1">Річно (1×/рік)</option>
            </select>
            <div class="hint">Внесок завжди щомісячний; капіталізація визначає, коли нараховуються %.</div>
          </div>
        </div>

        <div class="row" style="margin-top:8px">
          <div>
            <label>Початкова сума</label>
            <input id="p0" type="number" min="0" step="0.01" value="0">
          </div>
          <div>
            <label>Щомісячний внесок</label>
            <input id="pmt" type="number" min="0" step="0.01" value="100">
          </div>
        </div>

        <div class="row" style="margin-top:8px">
          <div>
            <label>Річна ставка, %</label>
            <input id="rate" type="number" min="0" step="0.01" value="8">
          </div>
          <div>
            <label>Горизонт</label>
            <div class="row" style="grid-template-columns:2fr 1fr">
              <input id="periodCount" type="number" min="1" step="1" value="5">
              <select id="periodUnit">
                <option value="years" selected>роки</option>
                <option value="months">місяці</option>
              </select>
            </div>
          </div>
        </div>

        <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
          <button class="btn btn-primary" id="calcBtn">Розрахувати</button>
          <button class="btn btn-ghost" id="resetBtn">Скинути</button>
        </div>
      </section>

      <!-- Результат -->
      <section class="card results">
        <div><span class="badge">Результат</span></div>
        <div class="result-box">
          <div>Через <b id="resHorizon">—</b> ви матимете</div>
          <div class="sum" id="resAmount">—</div>
        </div>

        <div class="chart-card">
          <div class="hint" style="margin-bottom:6px">Графік зростання балансу (номінал)</div>
          <canvas id="chart" width="900" height="300"></canvas>
          <div class="hint" style="margin-top:6px">
            <span style="display:inline-flex;align-items:center;gap:6px;margin-right:16px">
              <span style="width:14px;height:3px;background:var(--brand-1);display:inline-block;border-radius:3px"></span> Баланс
            </span>
          </div>
        </div>

        <div class="table-wrap">
          <table id="preview">
            <thead>
              <tr>
                <th>Місяць</th>
                <th>Баланс на поч.</th>
                <th>Внесок</th>
                <th>Нарах. %</th>
                <th>Баланс на кін.</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="hint">Показано перші 12 місяців. % відображаються лише в місяці капіталізації.</div>
      </section>
    </div>

    <!-- CTA -->
    <section class="cta" style="margin:16px 0">
      <div style="font-size:18px;font-weight:800">Потрібен персональний розбір портфеля?</div>
      <div>Отримайте консультацію від Крістіни — підбір стратегії, розрахунок цілей і ризик-профілю.</div>
      <a class="btn" href="https://www.instagram.com/stories/kristina_bessolova" target="_blank" rel="noopener">Отримати консультацію</a>
    </section>

    <!-- FAQ -->
    <section class="faq" style="margin:16px 0">
      <h2 style="font-size:20px;margin:0 0 8px">Міні-FAQ: складний відсоток</h2>
      <details>
        <summary>Що таке складний відсоток?</summary>
        <div class="hint" style="margin-top:8px">
          Це коли відсотки додаються до тіла інвестиції й у наступних періодах відсотки нараховуються вже на більшу суму (відсотки на відсотки).
        </div>
      </details>
      <details>
        <summary>Чим капіталізація відрізняється від внесків?</summary>
        <div class="hint" style="margin-top:8px">
          Внески — **щомісячні**. Капіталізація визначає **коли** нараховуються % (1/2/4/12 разів на рік). Частіша капіталізація = швидше зростання.
        </div>
      </details>
      <details>
        <summary>Чому результати відрізняються між «місячно» і «річно»?</summary>
        <div class="hint" style="margin-top:8px">
          При місячній капіталізації відсотки частіше додаються до балансу, тому працює ефект «відсоток на відсоток» частіше → підсумок більший.
        </div>
      </details>
    </section>
  </main>

  <footer>© Active Invest School. Освітній інструмент (не інвестрекомендація).</footer>

<script>
/* ===== Формат грошей ===== */
const fmtMoney = (x, cur='UAH') =>
  new Intl.NumberFormat('uk-UA', { style:'currency', currency:cur, maximumFractionDigits:2 }).format(x);

/* ===== Сервісні ===== */
function monthsTotal(unit, count){
  if (unit === 'months') return count;
  if (unit === 'years')  return count * 12;
  return count * 12;
}

/* ===== Модель компаундингу =====
   - Щомісячний внесок (PMT) — завжди.
   - Відсотки нараховуються кожні (12/m) місяців за ставкою (r/m).
   - Повертаємо: final, rows (12 міс), series (усі місяці) для графіка.
*/
function simulate({P0, PMT, annualRate, m, months}){
  const intervalMonths = Math.round(12 / m);   // 12→1, 4→3, 2→6, 1→12
  const iPeriod = annualRate / m;

  let balance = P0;
  const rows = [];
  const series = [balance];

  for (let t=1; t<=months; t++){
    const begin = balance;

    // 1) щомісячний внесок
    balance += PMT;

    // 2) нарахування % наприкінці періоду капіталізації
    let interestAdded = 0;
    if (t % intervalMonths === 0){
      const interest = balance * iPeriod;
      balance += interest;
      interestAdded = interest;
    }

    if (t <= 12){
      rows.push({month:t, begin, pmt:PMT, interest:interestAdded, end:balance});
    }
    series.push(balance);
  }
  return { final: balance, rows, series };
}

/* ===== Графік (Canvas) ===== */
function drawChart(series){
  const canvas = document.getElementById('chart');
  const ctx = canvas.getContext('2d');

  // Retina
  const dpr = window.devicePixelRatio || 1;
  canvas.width = canvas.clientWidth * dpr;
  canvas.height = canvas.clientHeight * dpr;
  ctx.scale(dpr, dpr);

  const w = canvas.clientWidth, h = canvas.clientHeight;
  ctx.clearRect(0,0,w,h);

  const padL = 48, padR = 12, padT = 12, padB = 28;

  const len = series.length;
  const min = Math.min(...series);
  const max = Math.max(...series);
  const yMin = Math.max(0, Math.floor(min));
  const yMax = Math.ceil(max);

  const X = (i)=> padL + ( (w - padL - padR) * (i / (len - 1 || 1)) );
  const Y = (v)=> padT + (h - padT - padB) * (1 - (v - yMin) / (yMax - yMin || 1));

  // grid
  ctx.strokeStyle = getComputedStyle(document.body).getPropertyValue('--line');
  ctx.lineWidth = 1;
  ctx.beginPath();
  for (let k=0; k<=4; k++){
    const y = padT + (h - padT - padB) * (k/4);
    ctx.moveTo(padL, y); ctx.lineTo(w - padR, y);
  }
  ctx.stroke();

  // y labels
  ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--ink');
  ctx.font = '12px Inter, system-ui, sans-serif';
  ctx.textAlign = 'right'; ctx.textBaseline = 'middle';
  for (let k=0; k<=4; k++){
    const v = yMax - (yMax - yMin) * (k/4);
    const y = padT + (h - padT - padB) * (k/4);
    ctx.fillText(shortNum(v), padL - 6, y);
  }

  // line
  ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--brand-1').trim() || '#0b8a4b';
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(X(0), Y(series[0]));
  for (let i=1; i<series.length; i++) ctx.lineTo(X(i), Y(series[i]));
  ctx.stroke();

  function shortNum(v){
    if (v >= 1e9) return (v/1e9).toFixed(1)+'B';
    if (v >= 1e6) return (v/1e6).toFixed(1)+'M';
    if (v >= 1e3) return (v/1e3).toFixed(0)+'k';
    return Math.round(v).toString();
  }
}

/* ===== Контролер ===== */
function calc(){
  const currency = document.getElementById('currency').value;
  const P0   = +document.getElementById('p0').value || 0;
  const PMT  = +document.getElementById('pmt').value || 0;
  const r    = (+document.getElementById('rate').value || 0) / 100;
  const m    = +document.getElementById('m').value;
  const unit = document.getElementById('periodUnit').value;
  const count= +document.getElementById('periodCount').value;
  const months = monthsTotal(unit, count);

  const { final, rows, series } = simulate({P0, PMT, annualRate:r, m, months});

  const horizonLabel = unit === 'years' ? `${count} років` : `${count} місяців`;
  document.getElementById('resHorizon').textContent = horizonLabel;
  document.getElementById('resAmount').textContent  = fmtMoney(final, currency);

  // таблиця
  const tb = document.querySelector('#preview tbody');
  tb.innerHTML = rows.map(r => `
    <tr>
      <td>${r.month}</td>
      <td>${fmtMoney(r.begin, currency)}</td>
      <td>${fmtMoney(r.pmt,   currency)}</td>
      <td>${fmtMoney(r.interest, currency)}</td>
      <td>${fmtMoney(r.end,   currency)}</td>
    </tr>
  `).join('');

  // графік
  drawChart(series);
}

function resetForm(){
  document.getElementById('currency').value = 'USD';
  document.getElementById('m').value = '12';
  document.getElementById('p0').value = '0';
  document.getElementById('pmt').value = '100';
  document.getElementById('rate').value = '8';
  document.getElementById('periodCount').value = '5';
  document.getElementById('periodUnit').value = 'years';
  document.querySelector('#preview tbody').innerHTML = '';
  document.getElementById('resHorizon').textContent = '—';
  document.getElementById('resAmount').textContent = '—';
  drawChart([0,0,0]); // очистити графік
}

document.getElementById('calcBtn').addEventListener('click', calc);
document.getElementById('resetBtn').addEventListener('click', resetForm);
</script>
</body>
</html>
